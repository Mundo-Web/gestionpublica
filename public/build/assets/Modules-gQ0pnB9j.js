var Y=Object.defineProperty;var J=(l,n,r)=>n in l?Y(l,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):l[n]=r;var f=(l,n,r)=>(J(l,typeof n!="symbol"?n+"":n,r),r);import{R as e,r as i}from"./HtmlContent-TT1qJ6UJ.js";import{c as O}from"./ReactAppend-eu1i41_3.js";import{R as X}from"./OfferForm-t6ezPxeD.js";import"./ProductCard-0xAfiOtl.js";import{C as Q}from"./CreateReactScript-Eox_dAvx.js";import{m as h}from"./main-jzs2GwAM.js";import{B as I}from"./BasicRest-FBWcr7qe.js";import{T as D}from"./tippy-react.esm-0Rdq6bjm.js";import{S as Z}from"./OfferCard-LiDsDtK5.js";import"./_commonjsHelpers-4gQjN7DL.js";import"./index-jLuiGAeD.js";import"./CreateReactScript-cqrtON1y.js";import"./axios-_sX4vCAy.js";const _=({imagen:l,producto:n,extract:r,hasShadow:c=!1,...s})=>e.createElement("button",{className:`w-full max-w-sm relative inline-flex items-center text-sm text-gray-500 hover:text-gray-900 focus:outline-none dark:hover:text-white dark:text-gray-400 bg-white px-4 py-3 rounded-md ${c&&"shadow-md"}`,...s},e.createElement("div",{className:"flex-shrink-0"},e.createElement("img",{className:"rounded-md w-11 h-11",src:`/${l}`,onError:d=>d.target.src="/images/img/noimagen.jpg",alt:n})),e.createElement("div",{className:"w-full ps-3 text-start"},e.createElement("h4",{className:"w-[calc(100%-40px)] font-semibold text-ellipsis text-nowrap overflow-hidden "},n),e.createElement("div",{className:"text-gray-500 text-xs mb-1.5 dark:text-gray-400"},r))),T=({eRef:l,type:n="text",name:r,label:c,required:s=!1,long:d=!1,rows:u=2,hidden:p=!1})=>(l||(l=i.useRef()),r||(r=`floating-${crypto.randomUUID()}`),e.createElement("div",{className:`relative z-0 w-full mb-4 group ${p?"hidden":""}`},d?e.createElement("textarea",{ref:l,name:r,id:r,className:"block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer",placeholder:" ",required:s,style:{minHeight:u*27,fieldSizing:"content"}}):e.createElement("input",{ref:l,type:n,name:r,id:r,className:"block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer",placeholder:" ",required:s}),e.createElement("label",{htmlFor:r,className:"peer-focus:font-medium absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-focus:start-0 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto peer-focus:text-blue-600 peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6"},c," ",s&&e.createElement("span",null,"*"))));class ee extends I{constructor(){super(...arguments);f(this,"path","modules");f(this,"byCourse",async r=>{try{const{status:c,result:s}=await h.Fetch(`/api/${this.path}/${r}`);if(!c)throw new Error((s==null?void 0:s.message)||"Ocurrio un error inesperado");return s.data}catch(c){return console.error(c.message),[]}});f(this,"save",async(r,c=!0)=>{try{const s=await fetch(`/api/${this.path}`,{method:"POST",headers:{"X-Xsrf-Token":decodeURIComponent(Cookies.get("XSRF-TOKEN"))},body:r});if(!s.ok){const u=await s.json();throw new Error((u==null?void 0:u.message)||"Ocurrió un error inesperado")}const d=await s.json();return c&&h.Notify.add({icon:"/assets/img/logo-login.svg",title:"Correcto",body:d.message,type:"success"}),d.data||!0}catch(s){return c&&h.Notify.add({icon:"/assets/img/logo-login.svg",title:"Error",body:s.message,type:"danger"}),null}})}}class te extends I{constructor(){super(...arguments);f(this,"path","sources");f(this,"save",async(r,c=!0)=>{try{const s=await fetch(`/api/${this.path}`,{method:"POST",headers:{"X-Xsrf-Token":decodeURIComponent(Cookies.get("XSRF-TOKEN"))},body:r});if(!s.ok){const u=await s.json();throw new Error((u==null?void 0:u.message)||"Ocurrió un error inesperado")}const d=await s.json();return c&&h.Notify.add({icon:"/assets/img/logo-login.svg",title:"Correcto",body:d.message,type:"success"}),d.data}catch(s){return c&&h.Notify.add({icon:"/assets/img/logo-login.svg",title:"Error",body:s.message,type:"danger"}),null}})}}X.setAppElement("body");const re={content:{maxWidth:"480px",width:"95%",top:"50%",left:"50%",transform:"translate(-50%, -50%)",height:"calc(100vh - 140px)"}},M=new ee,U=new te,ae=({courses:l})=>{const n=i.useRef(),[r,c]=i.useState(l[0]??null),[s,d]=i.useState([0,1,2,3]),[u,p]=i.useState(!1),[a,z]=i.useState(null),[w,C]=i.useState("image"),[E,R]=i.useState([]);i.useEffect(()=>{S()},[r]);const S=async()=>{const t=await M.byCourse(r==null?void 0:r.id);d(t)},A=()=>{$(n.current).removeClass("block"),$(n.current).addClass("hidden"),$(n.current).attr("style","position: absolute; inset: 0px auto auto 0px; margin: 0px; transform: translate(705.556px, 157.778px);")},L=t=>{A(),c(t)},B=(t=null)=>{z(t),p(!0)},k=i.useRef(),j=i.useRef(),F=i.useRef(),y=i.useRef(),b=i.useRef(),v=i.useRef(),P=async()=>{k.current.value=(a==null?void 0:a.id)||"",j.current.value=(a==null?void 0:a.name)||"",F.current.value=(a==null?void 0:a.description)||"";const t=(a==null?void 0:a.source_type)||"image";C(t),t=="image"?($("#source-type-image").prop("checked",!0),b.current.value=null,y.current.src=`/api/sources/${a==null?void 0:a.source}`,v.current.value=null):($("#source-type-video").prop("checked",!0),b.current.value=null,y.current.src=null,v.current.value=`https://youtu.be/${a==null?void 0:a.source}`),R((a==null?void 0:a.sources)||[])},q=async t=>{const o=t.target.files[0]??null;if(!o)return y.current.src=null;const m=URL.createObjectURL(o);y.current.src=m},K=()=>{z(null),p(!1)},V=async t=>{var g,x;t.preventDefault();const o=new FormData;o.append("course_id",r.id),o.append("id",k.current.value||""),o.append("name",j.current.value),o.append("description",F.current.value),o.append("source_type",w),w=="image"?(g=b.current.files)!=null&&g[0]&&o.append("source",((x=b.current.files)==null?void 0:x[0])??null):o.append("source",v.current.value),k.current.value||o.append("sources",E.map(({id:N})=>N));const m=await M.save(o);console.log(m),m&&(S(),p(!1))},G=t=>{[...t.target.files].forEach(async m=>{const g=new FormData;a!=null&&a.id&&g.append("module_id",a.id),g.append("source",m);const x=await U.save(g);if(!x)return;const N=structuredClone(E);N.push(x),R(N)}),t.target.value=null},H=async t=>{if(!await U.delete(t))return;const m=structuredClone(E).filter(({id:g})=>g!=t);R(m)},W=async()=>{const{isConfirmed:t}=await Z.fire({title:"¿Estás seguro?",text:"Esta acción eliminará el módulo de forma permanente.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});!t||!await M.delete(a.id)||(p(!1),S())};return e.createElement(e.Fragment,null,e.createElement("div",{className:"p-4 flex justify-center"},e.createElement("div",{className:"w-full max-w-sm"},e.createElement(_,{producto:r.producto,extract:r.extract,imagen:r.imagen,id:"dropdownNotificationButton","data-dropdown-toggle":"dropdownNotification",hasShadow:!0}),e.createElement("div",{ref:n,id:"dropdownNotification",className:"z-20 hidden w-full max-w-sm bg-white divide-y divide-gray-100 rounded-lg shadow dark:bg-gray-800 dark:divide-gray-700","aria-labelledby":"dropdownNotificationButton"},e.createElement("label",{htmlFor:"inputSearch",className:"flex font-medium text-center text-gray-700 rounded-t-lg bg-gray-50 dark:bg-gray-800 dark:text-white items-center"},e.createElement("i",{className:"fa fa-search text-lg py-2 px-3"}),e.createElement("input",{id:"inputSearch",className:"w-full bg-transparent outline-none border-none",type:"text",placeholder:"Buscar curso..."})),e.createElement("div",{className:"divide-y divide-gray-100 dark:divide-gray-700"},l.map((t,o)=>e.createElement(_,{key:`course-${o}`,...t,onClick:()=>L(t)}))),e.createElement("a",{href:"/admin/products/create",className:"block py-2 text-sm font-medium text-center text-gray-900 rounded-b-lg bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 dark:text-white"},e.createElement("div",{className:"inline-flex items-center "},e.createElement("i",{className:"fa fa-plus me-1"}),"Nuevo curso"))))),e.createElement("button",{className:"block mx-auto bg-white text-gray-700 shadow-md rounded-full py-2 px-4 hover:bg-gray-100",onClick:()=>B()},e.createElement("i",{className:"fa fa-plus me-1"})," Agregar modulo"),e.createElement("div",{className:"p-4 flex items-center justify-center gap-4 flex-wrap"},s.sort((t,o)=>t.order-o.order).map((t,o)=>e.createElement("div",{key:`module-${o}`,className:"relative flex flex-col items-center bg-white border border-gray-200 rounded-lg shadow-md md:flex-row md:max-w-sm hover:bg-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:hover:bg-gray-700 cursor-pointer",onClick:()=>B(t)},t.type=="session"?e.createElement(e.Fragment,null,e.createElement("img",{className:"object-cover w-full max-h-48 md:h-auto md:w-32 rounded-none rounded-t-lg md:rounded-none md:rounded-s-lg",src:t.source_type=="video"?`https://i.ytimg.com/vi/${t.source}/hq720.jpg`:`/api/sources/${t.source}`,alt:t.name,onError:m=>m.target.src="/images/img/noimagen.jpg"}),t.source_type=="video"&&e.createElement("i",{className:"absolute top-2 left-2 fab fa-youtube text-lg text-[#FF0000]"})):e.createElement("img",{className:"object-cover w-full max-h-48 md:h-auto md:w-32 rounded-none rounded-t-lg md:rounded-none md:rounded-s-lg",src:"/images/img/quizz-default.png",alt:t.name,onError:m=>m.target.src="/images/img/noimagen.jpg"}),e.createElement("div",{className:"flex flex-col justify-between p-4 leading-normal"},e.createElement("h5",{className:"mb-1 font-bold tracking-tight text-gray-900 dark:text-white line-clamp-2"},t.type=="quick-exam"?e.createElement("span",{className:"bg-yellow-100 text-yellow-800 text-xs font-medium me-1 px-2.5 py-0.5 rounded dark:bg-yellow-900 dark:text-yellow-300"},"Examen parcial"):t.type=="final-exam"?e.createElement("span",{className:"bg-red-100 text-red-800 text-xs font-medium me-1 px-2.5 py-0.5 rounded dark:bg-red-900 dark:text-red-300"},"Examen final"):""," ",t.name),e.createElement("p",{className:"font-normal text-gray-700 dark:text-gray-400 line-clamp-2"},t.description))))),e.createElement(X,{isOpen:u,style:re,onAfterOpen:P,onRequestClose:K},e.createElement("form",{onSubmit:V},e.createElement("input",{ref:k,type:"hidden",name:"id"}),e.createElement("ul",{className:"block mx-auto items-center w-max text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-lg sm:flex dark:bg-gray-700 dark:border-gray-600 dark:text-white"},e.createElement("li",{className:"w-max border-b border-gray-200 sm:border-b-0 sm:border-r dark:border-gray-600"},e.createElement("div",{className:"flex items-center ps-3"},e.createElement("input",{id:"horizontal-list-radio-id",type:"radio",value:"",name:"list-radio",className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-700 dark:focus:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500  cursor-pointer",defaultChecked:!0}),e.createElement("label",{htmlFor:"horizontal-list-radio-id",className:"w-full py-3 ps-2 pe-3 text-sm font-medium text-gray-900 dark:text-gray-300  cursor-pointer"},"Sesion"))),e.createElement("li",{className:"w-max dark:border-gray-600"},e.createElement("div",{className:"flex items-center ps-3"},e.createElement("input",{id:"horizontal-list-radio-passport",type:"radio",value:"",name:"list-radio",className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-700 dark:focus:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500 cursor-pointer"}),e.createElement("label",{htmlFor:"horizontal-list-radio-passport",className:"w-full py-3 ps-2 pe-3 text-sm font-medium text-gray-900 dark:text-gray-300 cursor-pointer"},"Evaluacion final")))),e.createElement("hr",{className:"my-4"}),e.createElement(T,{eRef:j,label:"Titulo de la sesion"}),e.createElement(T,{eRef:F,label:"Descripcion de la sesion",long:!0}),e.createElement("p",{className:"mb-2",htmlFor:""},"Recurso principal"),e.createElement("div",{className:"mb-4 flex w-full justify-center gap-4"},e.createElement("div",{className:"flex items-center ps-4 border border-gray-200 rounded dark:border-gray-700 w-full max-w-40"},e.createElement("input",{id:"source-type-image",type:"radio",value:"image",name:"source-type",className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600 cursor-pointer",onChange:t=>C(t.target.value)}),e.createElement("label",{htmlFor:"source-type-image",className:"w-full py-4 ms-2 text-sm font-medium text-gray-900 dark:text-gray-300 cursor-pointer"},"Imagen")),e.createElement("div",{className:"flex items-center ps-4 border border-gray-200 rounded dark:border-gray-700 w-full max-w-40"},e.createElement("input",{id:"source-type-video",type:"radio",value:"video",name:"source-type",className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600 cursor-pointer",onChange:t=>C(t.target.value)}),e.createElement("label",{htmlFor:"source-type-video",className:"w-full py-4 ms-2 text-sm font-medium text-gray-900 dark:text-gray-300 cursor-pointer"},"Video"))),e.createElement("label",{className:`w-full ${w=="image"?"block":"hidden"} cursor-pointer mb-4`,htmlFor:"input_image"},e.createElement("img",{ref:y,className:"block mx-auto w-[250px] h-[150px] object-cover object-center rounded-md",src:"/images/img/noimagen.jpg",alt:"",onError:t=>t.target.src="/images/img/noimagen.jpg"})),e.createElement("input",{ref:b,className:"hidden",id:"input_image",type:"file",onChange:q}),e.createElement(T,{eRef:v,label:"Link del video (YouTube)",hidden:w=="image"}),e.createElement("hr",{className:"my-4"}),e.createElement("div",{className:"flex justify-between items-center mb-2"},e.createElement("p",null,"Otros recursos"),e.createElement("label",{htmlFor:"input-source",className:"text-white bg-gray-800 hover:bg-gray-900 focus:outline-none focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-sm px-3 py-2 me-2 mb-2 dark:bg-gray-800 dark:hover:bg-gray-700 dark:focus:ring-gray-700 dark:border-gray-700 cursor-pointer"},e.createElement("i",{className:"fa fa-plus me-1"}),"Agregar"),e.createElement("input",{className:"hidden",type:"file",name:"input-source",id:"input-source",onChange:G})),e.createElement("div",{className:"flex gap-2 flex-col"},E.map((t,o)=>e.createElement("div",{key:`source-${o}`,className:"flex gap-2 justify-between items-center p-4 w-full bg-rose-50 rounded-xl max-md:max-w-full"},e.createElement("div",{className:"flex gap-3 items-center self-stretch my-auto min-w-[240px]"},e.createElement("i",{className:"far fa-file-alt text-[48px] text-rose-700 shrink-0 self-stretch"}),e.createElement("div",{className:"flex flex-col self-stretch my-auto w-[228px]"},e.createElement(D,{content:"Ver recurso"},e.createElement("a",{href:`/${t.ref}`,className:"w-[calc(100%-25px)] text-base font-medium leading-none text-neutral-800 text-ellipsis line-clamp-1 hover:underline",target:"_blank"},t.name)),e.createElement("div",{className:"mt-1 text-sm tracking-normal leading-loose text-rose-700"},Number(t.size/1e6).toFixed(2)," MB"))),e.createElement(D,{content:"Eliminar recurso"},e.createElement("button",{type:"button",className:"gap-3 self-stretch px-4 py-2 my-auto text-base font-bold leading-tight text-white whitespace-nowrap bg-rose-700 rounded-lg",onClick:()=>H(t.id)},e.createElement("i",{className:"fa fa-trash"})))))),e.createElement("button",{type:"submit",className:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 mt-4 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800 me-2"},e.createElement("i",{className:"fa fa-save me-1"}),"Guardar"),e.createElement("button",{type:"button",className:"text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 mt-4 dark:bg-red-600 dark:hover:bg-red-700 focus:outline-none dark:focus:ring-red-800",onClick:W},e.createElement("i",{className:"fa fa-trash me-1"}),"Eliminar"))))};Q((l,n)=>{O(l).render(e.createElement(ae,{...n}))});
