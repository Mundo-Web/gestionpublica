var Q=Object.defineProperty;var Z=(i,n,s)=>n in i?Q(i,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[n]=s;var p=(i,n,s)=>(Z(i,typeof n!="symbol"?n+"":n,s),s);import{j as e}from"./HtmlContent-MplZTE2r.js";import{r as l}from"./index-TT1qJ6UJ.js";import{c as O}from"./ReactAppend-Y0JQgEOA.js";import{R as A}from"./OfferForm-C9W44swn.js";import"./ProductCard-q3UQMrn8.js";import{C as ee}from"./CreateReactScript-QuaDmwri.js";import{m as j}from"./main-jzs2GwAM.js";import{B as L}from"./BasicRest-FBWcr7qe.js";import{T as I}from"./tippy-react.esm-Ethl7wjd.js";import{S as re}from"./OfferCard-mSyxeypM.js";import"./_commonjsHelpers-4gQjN7DL.js";import"./index-jtdEOcur.js";import"./CreateReactScript-gj-POL85.js";import"./axios-_sX4vCAy.js";const U=({imagen:i,producto:n,extract:s,hasShadow:c=!1,...o})=>e.jsxs("button",{className:`w-full max-w-sm relative inline-flex items-center text-sm text-gray-500 hover:text-gray-900 focus:outline-none dark:hover:text-white dark:text-gray-400 bg-white px-4 py-3 rounded-md ${c&&"shadow-md"}`,...o,children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{className:"rounded-md w-11 h-11",src:`/${i}`,onError:u=>u.target.src="/images/img/noimagen.jpg",alt:n})}),e.jsxs("div",{className:"w-full ps-3 text-start",children:[e.jsx("h4",{className:"w-[calc(100%-40px)] font-semibold text-ellipsis text-nowrap overflow-hidden ",children:n}),e.jsx("div",{className:"text-gray-500 text-xs mb-1.5 dark:text-gray-400",children:s})]})]}),w=({eRef:i,type:n="text",name:s,label:c,required:o=!1,long:u=!1,rows:m=2,hidden:x=!1})=>(i||(i=l.useRef()),s||(s=`floating-${crypto.randomUUID()}`),e.jsxs("div",{className:`relative z-0 w-full mb-4 group ${x?"hidden":""}`,children:[u?e.jsx("textarea",{ref:i,name:s,id:s,className:"block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer",placeholder:" ",required:o,style:{minHeight:m*27,fieldSizing:"content"}}):e.jsx("input",{ref:i,type:n,name:s,id:s,className:"block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer",placeholder:" ",required:o}),e.jsxs("label",{htmlFor:s,className:"peer-focus:font-medium absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-focus:start-0 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto peer-focus:text-blue-600 peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6",children:[c," ",o&&e.jsx("span",{children:"*"})]})]}));class se extends L{constructor(){super(...arguments);p(this,"path","modules");p(this,"byCourse",async s=>{try{const{status:c,result:o}=await j.Fetch(`/api/${this.path}/${s}`);if(!c)throw new Error((o==null?void 0:o.message)||"Ocurrio un error inesperado");return o.data}catch(c){return console.error(c.message),[]}});p(this,"save",async(s,c=!0)=>{try{const o=await fetch(`/api/${this.path}`,{method:"POST",headers:{"X-Xsrf-Token":decodeURIComponent(Cookies.get("XSRF-TOKEN"))},body:s});if(!o.ok){const m=await o.json();throw new Error((m==null?void 0:m.message)||"Ocurrió un error inesperado")}const u=await o.json();return c&&j.Notify.add({icon:"/assets/img/logo-login.svg",title:"Correcto",body:u.message,type:"success"}),u.data||!0}catch(o){return c&&j.Notify.add({icon:"/assets/img/logo-login.svg",title:"Error",body:o.message,type:"danger"}),null}})}}class te extends L{constructor(){super(...arguments);p(this,"path","sources");p(this,"save",async(s,c=!0)=>{try{const o=await fetch(`/api/${this.path}`,{method:"POST",headers:{"X-Xsrf-Token":decodeURIComponent(Cookies.get("XSRF-TOKEN"))},body:s});if(!o.ok){const m=await o.json();throw new Error((m==null?void 0:m.message)||"Ocurrió un error inesperado")}const u=await o.json();return c&&j.Notify.add({icon:"/assets/img/logo-login.svg",title:"Correcto",body:u.message,type:"success"}),u.data}catch(o){return c&&j.Notify.add({icon:"/assets/img/logo-login.svg",title:"Error",body:o.message,type:"danger"}),null}})}}A.setAppElement("body");const ae={content:{maxWidth:"480px",width:"95%",top:"50%",left:"50%",transform:"translate(-50%, -50%)",height:"max-content",maxHeight:"calc(100vh - 140px)"}},z=new se,X=new te,oe=({courses:i})=>{const n=l.useRef(),[s,c]=l.useState(i[0]??null),[o,u]=l.useState([0,1,2,3]),[m,x]=l.useState(!1),[t,B]=l.useState(null),[k,E]=l.useState("image"),[v,F]=l.useState([]),[N,T]=l.useState("session");l.useState([{}]),l.useEffect(()=>{M()},[s]);const M=async()=>{const r=await z.byCourse(s==null?void 0:s.id);u(r)},P=()=>{$(n.current).removeClass("block"),$(n.current).addClass("hidden"),$(n.current).attr("style","position: absolute; inset: 0px auto auto 0px; margin: 0px; transform: translate(705.556px, 157.778px);")},q=r=>{P(),c(r)},_=(r=null)=>{B(r),x(!0)},C=l.useRef(),f=l.useRef(),D=l.useRef(),h=l.useRef(),y=l.useRef(),R=l.useRef(),H=async()=>{const r=(t==null?void 0:t.type)||"session";T(r),C.current.value=(t==null?void 0:t.id)||"",f.current.value=(t==null?void 0:t.name)||"",D.current.value=(t==null?void 0:t.description)||"";const a=(t==null?void 0:t.source_type)||"image";E(a),a=="image"?($("#source-type-image").prop("checked",!0),y.current.value=null,h.current.src=`/api/sources/${t==null?void 0:t.source}`,R.current.value=null):($("#source-type-video").prop("checked",!0),y.current.value=null,h.current.src=null,R.current.value=`https://youtu.be/${t==null?void 0:t.source}`),F((t==null?void 0:t.sources)||[])},K=async r=>{const a=r.target.files[0]??null;if(!a)return h.current.src=null;const d=URL.createObjectURL(a);h.current.src=d},V=()=>{B(null),x(!1)},G=async r=>{var g,b;r.preventDefault();const a=new FormData;a.append("course_id",s.id),a.append("id",C.current.value||""),a.append("name",f.current.value),a.append("description",D.current.value),a.append("source_type",k),k=="image"?(g=y.current.files)!=null&&g[0]&&a.append("source",((b=y.current.files)==null?void 0:b[0])??null):a.append("source",R.current.value),C.current.value||a.append("sources",v.map(({id:S})=>S));const d=await z.save(a);console.log(d),d&&(M(),x(!1))},W=r=>{[...r.target.files].forEach(async d=>{const g=new FormData;t!=null&&t.id&&g.append("module_id",t.id),g.append("source",d);const b=await X.save(g);if(!b)return;const S=structuredClone(v);S.push(b),F(S)}),r.target.value=null},Y=async r=>{if(!await X.delete(r))return;const d=structuredClone(v).filter(({id:g})=>g!=r);F(d)},J=async()=>{const{isConfirmed:r}=await re.fire({title:"¿Estás seguro?",text:"Esta acción eliminará el módulo de forma permanente.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});!r||!await z.delete(t.id)||(x(!1),M())};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-4 flex justify-center",children:e.jsxs("div",{className:"w-full max-w-sm",children:[e.jsx(U,{producto:s.producto,extract:s.extract,imagen:s.imagen,id:"dropdownNotificationButton","data-dropdown-toggle":"dropdownNotification",hasShadow:!0}),e.jsxs("div",{ref:n,id:"dropdownNotification",className:"z-20 hidden w-full max-w-sm bg-white divide-y divide-gray-100 rounded-lg shadow dark:bg-gray-800 dark:divide-gray-700","aria-labelledby":"dropdownNotificationButton",children:[e.jsxs("label",{htmlFor:"inputSearch",className:"flex font-medium text-center text-gray-700 rounded-t-lg bg-gray-50 dark:bg-gray-800 dark:text-white items-center",children:[e.jsx("i",{className:"fa fa-search text-lg py-2 px-3"}),e.jsx("input",{id:"inputSearch",className:"w-full bg-transparent outline-none border-none",type:"text",placeholder:"Buscar curso..."})]}),e.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:i.map((r,a)=>e.jsx(U,{...r,onClick:()=>q(r)},`course-${a}`))}),e.jsx("a",{href:"/admin/products/create",className:"block py-2 text-sm font-medium text-center text-gray-900 rounded-b-lg bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 dark:text-white",children:e.jsxs("div",{className:"inline-flex items-center ",children:[e.jsx("i",{className:"fa fa-plus me-1"}),"Nuevo curso"]})})]})]})}),e.jsxs("button",{className:"block mx-auto bg-white text-gray-700 shadow-md rounded-full py-2 px-4 hover:bg-gray-100",onClick:()=>_(),children:[e.jsx("i",{className:"fa fa-plus me-1"})," Agregar modulo"]}),e.jsx("div",{className:"p-4 flex items-center justify-center gap-4 flex-wrap",children:o.sort((r,a)=>r.order-a.order).map((r,a)=>e.jsxs("div",{className:"relative flex flex-col items-center bg-white border border-gray-200 rounded-lg shadow-md md:flex-row md:max-w-sm hover:bg-gray-100 dark:border-gray-700 dark:bg-gray-800 dark:hover:bg-gray-700 cursor-pointer",onClick:()=>_(r),children:[r.type=="session"?e.jsxs(e.Fragment,{children:[e.jsx("img",{className:"object-cover w-full max-h-48 md:h-auto md:w-32 rounded-none rounded-t-lg md:rounded-none md:rounded-s-lg",src:r.source_type=="video"?`https://i.ytimg.com/vi/${r.source}/hq720.jpg`:`/api/sources/${r.source}`,alt:r.name,onError:d=>d.target.src="/images/img/noimagen.jpg"}),r.source_type=="video"&&e.jsx("i",{className:"absolute top-2 left-2 fab fa-youtube text-lg text-[#FF0000]"})]}):e.jsx("img",{className:"object-cover w-full max-h-48 md:h-auto md:w-32 rounded-none rounded-t-lg md:rounded-none md:rounded-s-lg",src:"/images/img/quizz-default.png",alt:r.name,onError:d=>d.target.src="/images/img/noimagen.jpg"}),e.jsxs("div",{className:"flex flex-col justify-between p-4 leading-normal",children:[e.jsxs("h5",{className:"mb-1 font-bold tracking-tight text-gray-900 dark:text-white line-clamp-2",children:[r.type=="quick-exam"?e.jsx("span",{className:"bg-yellow-100 text-yellow-800 text-xs font-medium me-1 px-2.5 py-0.5 rounded dark:bg-yellow-900 dark:text-yellow-300",children:"Examen parcial"}):r.type=="final-exam"?e.jsx("span",{className:"bg-red-100 text-red-800 text-xs font-medium me-1 px-2.5 py-0.5 rounded dark:bg-red-900 dark:text-red-300",children:"Examen final"}):""," ",r.name]}),e.jsx("p",{className:"font-normal text-gray-700 dark:text-gray-400 line-clamp-2",children:r.description})]})]},`module-${a}`))}),e.jsx(A,{isOpen:m,style:ae,onAfterOpen:H,onRequestClose:V,children:e.jsxs("form",{onSubmit:G,children:[e.jsx("input",{ref:C,type:"hidden",name:"id"}),e.jsxs("ul",{className:"block mx-auto items-center w-max text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-lg sm:flex dark:bg-gray-700 dark:border-gray-600 dark:text-white",children:[e.jsx("li",{className:"w-max border-b border-gray-200 sm:border-b-0 sm:border-r dark:border-gray-600",children:e.jsxs("div",{className:"flex items-center ps-3",children:[e.jsx("input",{id:"horizontal-list-radio-id",type:"radio",value:"session",name:"list-radio",className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-700 dark:focus:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500  cursor-pointer",defaultChecked:!0,onChange:r=>T(r.target.value)}),e.jsx("label",{htmlFor:"horizontal-list-radio-id",className:"w-full py-3 ps-2 pe-3 text-sm font-medium text-gray-900 dark:text-gray-300  cursor-pointer",children:"Sesion"})]})}),e.jsx("li",{className:"w-max dark:border-gray-600",children:e.jsxs("div",{className:"flex items-center ps-3",children:[e.jsx("input",{id:"horizontal-list-radio-passport",type:"radio",value:"final-exam",name:"list-radio",className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-700 dark:focus:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500 cursor-pointer",onChange:r=>T(r.target.value)}),e.jsx("label",{htmlFor:"horizontal-list-radio-passport",className:"w-full py-3 ps-2 pe-3 text-sm font-medium text-gray-900 dark:text-gray-300 cursor-pointer",children:"Evaluacion final"})]})})]}),e.jsx("hr",{className:"my-4"}),e.jsx(w,{eRef:f,label:N=="session"?"Titulo de la sesion":"Titulo del examen"}),e.jsx(w,{eRef:D,label:N=="session"?"Descripcion de la sesion":"Descripcion del examen",long:!0}),e.jsxs("div",{className:N=="session"?"block":"hidden",children:[e.jsx("p",{className:"mb-2",htmlFor:"",children:"Recurso principal"}),e.jsxs("div",{className:"mb-4 flex w-full justify-center gap-4",children:[e.jsxs("div",{className:"flex items-center ps-4 border border-gray-200 rounded dark:border-gray-700 w-full max-w-40",children:[e.jsx("input",{id:"source-type-image",type:"radio",value:"image",name:"source-type",className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600 cursor-pointer",onChange:r=>E(r.target.value)}),e.jsx("label",{htmlFor:"source-type-image",className:"w-full py-4 ms-2 text-sm font-medium text-gray-900 dark:text-gray-300 cursor-pointer",children:"Imagen"})]}),e.jsxs("div",{className:"flex items-center ps-4 border border-gray-200 rounded dark:border-gray-700 w-full max-w-40",children:[e.jsx("input",{id:"source-type-video",type:"radio",value:"video",name:"source-type",className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600 cursor-pointer",onChange:r=>E(r.target.value)}),e.jsx("label",{htmlFor:"source-type-video",className:"w-full py-4 ms-2 text-sm font-medium text-gray-900 dark:text-gray-300 cursor-pointer",children:"Video"})]})]}),e.jsx("label",{className:`w-full ${k=="image"?"block":"hidden"} cursor-pointer mb-4`,htmlFor:"input_image",children:e.jsx("img",{ref:h,className:"block mx-auto w-[250px] h-[150px] object-cover object-center rounded-md",src:"/images/img/noimagen.jpg",alt:"",onError:r=>r.target.src="/images/img/noimagen.jpg"})}),e.jsx("input",{ref:y,className:"hidden",id:"input_image",type:"file",onChange:K}),e.jsx(w,{eRef:R,label:"Link del video (YouTube)",hidden:k=="image"}),e.jsx("hr",{className:"my-4"}),e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("p",{children:"Otros recursos"}),e.jsxs("label",{htmlFor:"input-source",className:"text-white bg-gray-800 hover:bg-gray-900 focus:outline-none focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-sm px-3 py-2 me-2 mb-2 dark:bg-gray-800 dark:hover:bg-gray-700 dark:focus:ring-gray-700 dark:border-gray-700 cursor-pointer",children:[e.jsx("i",{className:"fa fa-plus me-1"}),"Agregar"]}),e.jsx("input",{className:"hidden",type:"file",name:"input-source",id:"input-source",onChange:W})]}),e.jsx("div",{className:"flex gap-2 flex-col",children:v.map((r,a)=>e.jsxs("div",{className:"flex gap-2 justify-between items-center p-4 w-full bg-rose-50 rounded-xl max-md:max-w-full",children:[e.jsxs("div",{className:"flex gap-3 items-center self-stretch my-auto min-w-[240px]",children:[e.jsx("i",{className:"far fa-file-alt text-[48px] text-rose-700 shrink-0 self-stretch"}),e.jsxs("div",{className:"flex flex-col self-stretch my-auto w-[228px]",children:[e.jsx(I,{content:"Ver recurso",children:e.jsx("a",{href:`/${r.ref}`,className:"w-[calc(100%-25px)] text-base font-medium leading-none text-neutral-800 text-ellipsis line-clamp-1 hover:underline",target:"_blank",children:r.name})}),e.jsxs("div",{className:"mt-1 text-sm tracking-normal leading-loose text-rose-700",children:[Number(r.size/1e6).toFixed(2)," MB"]})]})]}),e.jsx(I,{content:"Eliminar recurso",children:e.jsx("button",{type:"button",className:"gap-3 self-stretch px-4 py-2 my-auto text-base font-bold leading-tight text-white whitespace-nowrap bg-rose-700 rounded-lg",onClick:()=>Y(r.id),children:e.jsx("i",{className:"fa fa-trash"})})})]},`source-${a}`))})]}),e.jsxs("div",{className:`${N=="final-exam"?"flex":"hidden"} flex-col md:flex-row gap-2`,children:[e.jsx(w,{eRef:f,label:"Duracion",type:"number"}),e.jsx(w,{eRef:f,label:"Intentos",type:"number"})]}),e.jsxs("button",{type:"submit",className:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 mt-4 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800 me-2",children:[e.jsx("i",{className:"fa fa-save me-1"}),"Guardar"]}),e.jsxs("button",{type:"button",className:"text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 mt-4 dark:bg-red-600 dark:hover:bg-red-700 focus:outline-none dark:focus:ring-red-800",onClick:J,children:[e.jsx("i",{className:"fa fa-trash me-1"}),"Eliminar"]})]})})]})};ee((i,n)=>{O(i).render(e.jsx(oe,{...n}))});
