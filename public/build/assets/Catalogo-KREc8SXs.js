import{j as r}from"./HtmlContent-BKdWb2kD.js";import{r as o}from"./index-TykbAVkI.js";import{c as k}from"./ReactAppend-Atrjsk56.js";import{C as N}from"./CreateReactScript-URQ-tGt4.js";import{F as S,P as O,a as R}from"./ProductCard-mzE23k0W.js";import{m as T}from"./main-jzs2GwAM.js";import{a as J}from"./tippy-react.esm-jqeX8ySg.js";import"./_commonjsHelpers-4gQjN7DL.js";import"./index-T3_L0chj.js";import"./CreateReactScript-0UY9hQcZ.js";import"./axios-_sX4vCAy.js";import"./ProductCard-7TqcbfvX.js";const M=({minPrice:l,maxPrice:p,categories:_,tags:P,attribute_values:j,id_cat:m,tag_id:f,subCatId:g})=>{o.useEffect(()=>{const e=document.createElement("script");return e.src="https://cdn.sode.me/extends/notify.extend.min.js",e.async=!0,document.body.appendChild(e),()=>{document.body.removeChild(e)}},[null]);const[F,v]=o.useState([]),[t,x]=o.useState(m?{category_id:[m]}:{"txp.tag_id":[f]}),[u,C]=o.useState(0),[c,h]=o.useState(1);o.useEffect(()=>{g!==null&&x({...t,subcategory_id:[g]})},[]),o.useEffect(()=>{h(1),b()},[t]),o.useEffect(()=>{b()},[c]);const b=async()=>{const e=[];if((t.maxPrice||t.minPrice)&&(t.maxPrice&&t.minPrice?e.push([[["precio",">=",t.minPrice],"or",["descuento",">=",t.minPrice]],"and",[["precio","<=",t.maxPrice],"or",["descuento","<=",t.maxPrice]]]):t.minPrice?e.push([["precio",">=",t.minPrice],"or",["descuento",">=",t.minPrice]]):t.maxPrice&&e.push([["precio","<=",t.maxPrice],"or",["descuento","<=",t.maxPrice]])),t["txp.tag_id"]&&t["txp.tag_id"].length>0){const i=[];t["txp.tag_id"].forEach((s,a)=>{a==0?i.push(["txp.tag_id","=",s]):i.push("or",["txp.tag_id","=",s])}),e.push(i)}for(const i in t){if(!i.startsWith("attribute-")||t[i].length==0)continue;const[,s]=i.split("-"),a=[];t[i].forEach((y,E)=>{E==0?a.push(["apv.attribute_value_id","=",y]):a.push("or",["apv.attribute_value_id","=",y])}),e.push([["a.id","=",s],"and",a])}if(t.category_id&&t.category_id.length>0){const i=[];t.category_id.forEach((s,a)=>{a==0?i.push(["categoria_id","=",s]):i.push("or",["categoria_id","=",s])}),e.push(i)}if(t.subcategory_id&&t.subcategory_id.length>0){const i=[];t.subcategory_id.forEach((s,a)=>{a==0?i.push(["subcategory_id","=",s]):i.push("or",["subcategory_id","=",s])}),e.push(i)}const{status:n,result:d}=await T.Fetch("/api/products/paginate",{method:"POST",body:JSON.stringify({requireTotalCount:!0,filter:J([...e,["products.visible","=",!0]],"and"),take:12,skip:12*(c-1)})});v((d==null?void 0:d.data)??[]),C((d==null?void 0:d.totalCount)??0)},w=j.reduce((e,n)=>(e[n.attribute_id]||(e[n.attribute_id]=[]),e[n.attribute_id].push(n),e),{});return r.jsx(r.Fragment,{children:r.jsxs("form",{className:"flex flex-col md:flex-row gap-6  mx-auto font-poppins bg-[#F1F1F1] w-full",style:{padding:"40px"},children:[r.jsx("section",{className:"flex flex-col gap-4 md:basis-3/12 bg-white p-6 rounded-lg h-max md:sticky top-2",children:r.jsx(S,{setFilter:x,filter:t,minPrice:l??0,maxPrice:p??0,categories:_,tags:P,attribute_values:Object.values(w),selected_category:m,tag_id:f})}),r.jsxs("section",{className:"flex flex-col gap-6 md:basis-9/12",children:[r.jsx("div",{className:"w-full bg-white rounded-lg font-medium flex flex-row justify-between items-center px-2 py-3",children:r.jsx("div",{children:r.jsxs("span",{className:"font-normal text-[17px] text-[#666666] ml-3",children:["Mostrando ",(c-1)*12+1," - ",c*12>u?u:c*12," de ",u," resultados"]})})}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 xl:grid-cols-4 gap-4 pr-4",children:F.map((e,n)=>r.jsx(O,{item:e,bgcolor:"bg-white"},`product-${e.id}`))}),r.jsx("div",{className:"w-full font-medium flex flex-row justify-center items-center",children:r.jsx(R,{current:c,setCurrent:h,pages:Math.ceil(u/12)})})]})]})})};N((l,p)=>{k(l).render(r.jsx(M,{...p}))});
